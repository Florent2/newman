<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>settings.rb</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div id="jump_to">
    Jump To &hellip;
    <div id="jump_wrapper">
      <div id="jump_page">
          <a class="source" href="../newman.html">newman.rb</a>
          <a class="source" href="application.html">application.rb</a>
          <a class="source" href="controller.html">controller.rb</a>
          <a class="source" href="email_logger.html">email_logger.rb</a>
          <a class="source" href="filters.html">filters.rb</a>
          <a class="source" href="mailer.html">mailer.rb</a>
          <a class="source" href="mailing_list.html">mailing_list.rb</a>
          <a class="source" href="recorder.html">recorder.rb</a>
          <a class="source" href="request_logger.html">request_logger.rb</a>
          <a class="source" href="response_logger.html">response_logger.rb</a>
          <a class="source" href="server.html">server.rb</a>
          <a class="source" href="settings.html">settings.rb</a>
          <a class="source" href="store.html">store.rb</a>
          <a class="source" href="test_mailer.html">test_mailer.rb</a>
          <a class="source" href="version.html">version.rb</a>
      </div>
    </div>
  </div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>settings.rb</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-1">&#182;</a>
        </div>
        <p><code>Newman::Settings</code> provides the base functionality that is used by Newman&rsquo;s
configuration files. It is currently a thin wrapper on top of Ruby&rsquo;s
<code>OpenStruct</code> construct, but will later add some domain specific validations
and transformations for the various configuration options it supports.</p>

<p>Unless you need to customize the way that Newman&rsquo;s configuration system
works or make changes to your settings objects at runtime, you probably don&rsquo;t
need to worry about how this object is implemented. Both
<code>Newman::Server.simple</code> and <code>Newman::Server.test_mode</code> create a
<code>Newman::Settings</code> object for you automatically, and you will typically be
tweaking a sample settings file rather than crafting one from scratch.</p>

<p><code>Newman::Settings</code>is part of Newman&rsquo;s <strong>internal API</strong>, but 
the setting file format and various settings that Newman depends
on should be considered part of the <strong>external API</strong>.</p>

<p>The following settings are currently supported:</p>

<pre><code>imap.address
imap.user
imap.password
imap.ssl_enabled (default false)
imap.port

smtp.address
smtp.user
smtp.password
smtp.starttls_enabled  (default false)
smtp.port

service.debug_mode
  log error backtraces and full request and response emails

service.default_sender
  default FROM field for responses, can be changed by applications

service.domain
  mail domain, used by filters and in building email addresses

service.polling_interval
  idle seconds between server ticks (checking and processing email)

service.raise_exceptions
  raise exceptions during server ticks, killing the server

service.templates_dir
  directory of template files, relative to the application root
</code></pre>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-2'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-2">&#182;</a>
        </div>
        <hr>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="k">module</span> <span class="nn">Newman</span> 
  <span class="k">class</span> <span class="nc">Settings</span></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <hr>
      </td>
      <td class=code>
        <div class='highlight'><pre>    </pre></div>
      </td>
    </tr>
    <tr id='section-4'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-4">&#182;</a>
        </div>
        <p>The <code>Newman::Settings.from_file</code> method is used to create
a new <code>Newman::Settings</code> object and populate it with the data 
contained in a settings file, i.e.</p>

<pre><code>settings = Newman::Settings.from_file(&lsquo;config/environment.rb&rsquo;)
</code></pre>

<p>This method is purely syntactic sugar, and is functionally equivalent to
the following code:</p>

<pre><code>settings = Newman::Settings.new
settings.load_config(&lsquo;config/environment.rb&rsquo;)
</code></pre>

<p>Because there currently is little advantage to explicitly instantiating a
blank <code>Newman::Settings</code> object, this method is the preferred way of doing
things.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
      <span class="kp">new</span><span class="o">.</span><span class="n">tap</span> <span class="p">{</span> <span class="o">|</span><span class="n">o</span><span class="o">|</span> <span class="n">o</span><span class="o">.</span><span class="n">load_config</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="p">}</span>
    <span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-5'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-5">&#182;</a>
        </div>
        <hr>
      </td>
      <td class=code>
        <div class='highlight'><pre>     </pre></div>
      </td>
    </tr>
    <tr id='section-6'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-6">&#182;</a>
        </div>
        <p>A <code>Newman::Settings</code> object is a blank slate upon creation. It simply
assigns an empty <code>OpenStruct</code> object for each type of settings data it 
supports.     </p>

<p>In most situations, you will not instantiate a <code>Newman::Settings</code> object
directly but instead will make use of a configuration file and the
<code>Newman::Settings.from_file</code> method. Newman provides sample configuration
files in its <code>examples/</code> and <code>test/</code> directories, and applications should do the
same. This will help users discover what fields can be set.</p>

<p>We are aware of the fact that the current configuration system is way too
flexible and a breeding ground for subtle bugs. This will be fixed in a
future version of Newman.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="k">def</span> <span class="nf">initialize</span>
      <span class="nb">self</span><span class="o">.</span><span class="n">imap</span>        <span class="o">=</span> <span class="no">OpenStruct</span><span class="o">.</span><span class="n">new</span>
      <span class="nb">self</span><span class="o">.</span><span class="n">smtp</span>        <span class="o">=</span> <span class="no">OpenStruct</span><span class="o">.</span><span class="n">new</span>
      <span class="nb">self</span><span class="o">.</span><span class="n">service</span>     <span class="o">=</span> <span class="no">OpenStruct</span><span class="o">.</span><span class="n">new</span>
      <span class="nb">self</span><span class="o">.</span><span class="n">application</span> <span class="o">=</span> <span class="no">OpenStruct</span><span class="o">.</span><span class="n">new</span>
    <span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-7'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-7">&#182;</a>
        </div>
        <hr>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-8'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-8">&#182;</a>
        </div>
        <p>The <code>imap</code> and <code>smtp</code> fields are used by <code>Newman::Mailer</code>, 
the <code>service</code> field is used throughout Newman (particularly in
<code>Newman::Server</code>), and the <code>application</code> field is reserved for
application-specific configurations.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="kp">attr_accessor</span> <span class="ss">:imap</span><span class="p">,</span> <span class="ss">:smtp</span><span class="p">,</span> <span class="ss">:service</span><span class="p">,</span> <span class="ss">:application</span></pre></div>
      </td>
    </tr>
    <tr id='section-9'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-9">&#182;</a>
        </div>
        <hr>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-10'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-10">&#182;</a>
        </div>
        <p><code>Newman::Settings#load_config</code> is used for evaluating
the contents of a file within the context of a <code>Newman::Settings</code>
instance. </p>

<p>In practice, this method is typically called by
<code>Newman::Settings#from_file</code>, but can also be used to apply 
multiple settings files to a single <code>Newman::Settings</code> object</p>

      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
      <span class="nb">eval</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="nb">binding</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
